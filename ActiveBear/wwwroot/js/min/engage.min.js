"use strict"; var messager, ReceiveMessage = "ReceiveMessage", ReceiveAllMessages = "ReceiveAllMessages", CurrentUser = "CurrentUser", Notification = "Notification", connection = (new signalR.HubConnectionBuilder).withUrl("/chatHub").build(), currentUser = document.getElementById("currentUser"), messageInput = document.getElementById("messageInput"), passwordInput = document.getElementById("passwordInput"), messageContainer = document.getElementById("container"), body = document.getElementById("body"), navBar = document.getElementById("navbar"), bodyContent = document.getElementsByClassName("body-content")[0]; messageInput.addEventListener("keydown", function (e) { "Enter" === e.key && ChatHub.PostMessage() }), connection.on(ReceiveMessage, function (e) { var n = JSON.parse(e); messager.CreateMessageBubble(n) }), connection.on(CurrentUser, function (e) { currentUser.innerHTML = e }), connection.on(ReceiveAllMessages, function (e) { JSON.parse(e).forEach(function (e) { messager.CreateMessageBubble(e) }) }), connection.on(Notification, function (e) { messager.Notification(e) }), connection.start().then(function () { var e = $("#navbar").height(), n = window.innerHeight - e - 50 + "px", t = Math.round(.9 * screen.width) + "px"; messageContainer.style.height = n, messageContainer.style.width = t, messageInput.style.width = t, navBar.style.width = screen.width + "px", bodyContent.style.height = screen.height - e + "px", messageContainer.style.height = screen.height - 100 + "px", messager = new Messager(messageInput, passwordInput, messageContainer), ChatHub.GetCurrentUser(), ChatHub.RequestAllMessages(), document.documentElement.scrollTop = document.documentElement.scrollHeight }).catch(function (e) { return console.error(e.toString()) });